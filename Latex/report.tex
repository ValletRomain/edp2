\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsthm, amsmath, amssymb, mathrsfs}
\usepackage{tikz}
\usepackage{graphics}
\usepackage{float}
\usepackage{multicol}

\newtheorem{recap}{Recapitulation}

\title{Master 2 CSMI : EDP2\\Rapport de TP}
\author{Romain Vallet}

\begin{document}

\maketitle

\section{Rappel de cours}

Nous résolvons les équations du type :
\[ \partial_t u + \partial_x \left(f(u)\right) = 0 \label{eq} \tag{EQ} \]

Avec $u : \mathbb{R} \times \mathbb{R}^{+} \mapsto \mathbb{R}$ inconnue et $f : \mathbb{R} \mapsto \mathbb{R}$ connue.

Qui peut s'écrire :
\[ \partial_t u + f'(u) \partial_x u = 0 \label{eq2} \tag{EQ2} \]

\subsection{Solveur de Riemann}

Le problème de Riemann lié à l'équation \ref{eq} est le problème d'inconnue $u$ :

\[ \left\{ \begin{matrix}
	\partial_t u + \partial_x \left(f(u)\right) = 0 \text{   }\ref{eq} \\
	u(x,0) = \left\{ \begin{matrix}
				u_L \text{ si } x < 0 \\
				u_R \text{ si } x > 0
	\end{matrix} \right.
\end{matrix} \right.\]

On écrit le solveur de Riemann $R(u_L, u_R, z)$ tel que :
\[ R(u_L, u_R, \frac{x}{t}) = u(x,t) \]

\subsection{Schéma de Rusanov}

Le schéma de Rusanov est régit par la discrétisation :
\[ \frac{u_i^{n+1}-u_i^n}{\Delta t} + \frac{f(u_i^n,u_{i+1}^n) - f(u_{i-1}^n,u_i^n)}{\Delta x} = 0 \]

Avec $f$ le flux de Rusanov :
\[f(a,b) = \frac{f(a)+f(b)}{2} - \frac{\lambda(a,b)}{2} (b-a)\]

Avec $R$ le solveur de Riemann lié à l'équation à résoudre.

Avec $\lambda(a,b) = max \left(|f'(a)|, |f'(b)|\right)$.

\subsection{Schéma de Godunov}

Le schéma de Godunov est régit par la discrétisation :
\[ \frac{u_i^{n+1}-u_i^n}{\Delta t} + \frac{f(u_i^n,u_{i+1}^n) - f(u_{i-1}^n,u_i^n)}{\Delta x} = 0 \]

Avec $f$ le flux de Godunov :
\[f(a,b) = f(R(a,b,0))\]

Nous avons une contraintes $2\lambda \Delta t < \Delta x$ avec $\lambda = max_i |f'(u_i^n)|$.

\subsection{Schéma MUSCL}

Le schéma de Rusanov est régit par la discrétisation :
\[ \frac{u_i^{n+1}-u_i^n}{\Delta t} + \frac{f(u_{i+\frac{1}{2},-}^n,u_{i+\frac{1}{2},+}^n) - f(u_{i-\frac{1}{2},-}^n,u_{i-\frac{1}{2},+}^n)}{\Delta x} = 0 \]

Avec :
\begin{itemize}
	\item $u_{i+\frac{1}{2},-}^n = u_i^n - \frac{\Delta x}{2} s_i^n$
	\item $u_{i+\frac{1}{2},+}^n = u_i^n + \frac{\Delta x}{2} s_i^n$
	\item $s_i^n = minmod(\alpha, \beta, \gamma) = \left\{ \begin{matrix} min(\alpha, \beta, \gamma) \text{ si } \alpha, \beta, \gamma < 0 \\ max(\alpha, \beta, \gamma) \text{ si } \alpha, \beta, \gamma > 0 \\ 0 \text{ sinon} \end{matrix} \right.$, avec $\left\{ \begin{matrix} \alpha = \frac{w_i^n - w_{i-1}^n}{\Delta x} \\ \beta = \frac{w_{i+1}^n - w_i^n}{\Delta x} \\ \gamma = \frac{w_{i+1}^n - w_{i-1}^n}{\Delta x} \end{matrix} \right.$
\end{itemize}

Et le flux $f$, reste le même que dans la méthode de Godunov :
\[f(a,b) = f(R(a,b,0))\]

Pour faciliter l'implémentation, nous introduisons $r_i^n = \Delta x \; s_i^n$ (les $\Delta x$ disparaissent du calcul du flux).

\section{question}

Les codes de la résolution numérique du schéma de Godunov est placé dans un repository sous github ($\textit{https://github.com/ValletRomain/edp\_tp1}$ à la branche TP1).

Certaines fonctionalités du code ne fonctionne pas notament la méthode MUSCL.

\subsection{Résolution numérique de l’équation de transport}

\subsubsection*{1.}

\[ \left\{ \begin{matrix}
\partial_t u + c \partial_x u &=& 0 \text{ avec } t \in ]0,T[ \text{ et } x \in ]0,L[  \\
u(0,t) &=& e^{-t} \text{ avec } t \in ]0,T[ \\
u(x,0) &=& 0 \text{ avec } x \in ]0,L[
\end{matrix} \right.
\label{trans1} \tag{Transport1} \]

Avec $c>0$
\newline

La solution de \ref{trans1} est de la forme :

\[
\left\{
\begin{array}{ll}
    u(x,t) = u(x-ct,0) = 0 \text{ avec } x \geq ct \\
    u(x,t) = u(0,t-\frac{x}{c}) = e^{\frac{x}{c}-t} \text{ avec } x < ct
\end{array}
\right.
\tag{Sol1}
\]

\subsubsection*{2.}

Si $c < 0$ :

On a pour $t \in ]0,T[$, $-ct>0$, avec l'analyse des courbes caractéristiques, nous avons :

\begin{eqnarray*}
u(0,t) &=& u(-ct,0) \\
e^{-t} &=& 0
\end{eqnarray*}

Nous avons une contradiction, il n'y a pas de solution.
\newline

\subsubsection*{3.}

\begin{recap}{Schéma de Godunov pour l'équation de transport}

Pour l'équation de transport (avec $c>0$), nous avons :

$\bullet$ $f(u) = c u$

$\bullet$ Solveur de Riemann :
\[ R(u_L, u_R, z) = \left\{ \begin{matrix}
	
	\left\{ \begin{matrix}
		u_L \text{ pour } z < u_L \\
		z \text{ pour } u_l < z < u_R \\
		u_R \text{ pour } z > u_R	
	\end{matrix} \right. \text{ si } u_L < u_R \\
	
	\left\{ \begin{matrix} 
		u_L \text{ pour } z < c \\
		u_R \text{ pour } z > c
	\end{matrix} \right. \text{ si } u_L > u_R

	\end{matrix} \right. \]

$\bullet$ Flux de Godunov pour le cas $u_L > u_R$ :
\[ f(a,b) = c R(u_L,u_R,0) = c u_L \]

\end{recap}

\subsubsection*{4.}

Voici un graphique des erreur en norme $L^1$ en fonction de $N$ (nombre de point spatiaux) pour $t_{max}=0.5$ :

J'en profite pour présenter mes résultats pour les schéma de Rusanov et MUSCL.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/error_transport.png}
	\caption{Graphique des erreurs en norme $L^1$ en fonction de $N$}
\end{figure}

Les courbes de l'erreur du shéma de Godunov et de Rusanov se superposent. C'est normal, le flux de Godunov 
et de Rusanov sont égaux.

Nous pouvons observer que les courbes des shémas de Rusanov et de Godunov décroissent vers 0. C'est schéma 
sont convergent vers la solution attendue par rapport à $N$.

Quand au schéma MUSCL, nous voyons que cette méthode diverge. Il doit y avoir des problèmes dans mes codes.

\subsubsection*{5.}

Voici le résultat obtenue pour la résolution de l'équation de transport pour une $cfl=1.1$.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/transport_unstable.png}
	\caption{Résolution de l'équation de transport $cfl=1.01$ et $tmax=0.5$}
\end{figure}

Nous voyons que la solution diverge fortement.

\subsection{Résolution numérique de l’équation de Burgers}

\subsubsection*{1. }

\[ \left\{ \begin{matrix}
	\partial_t u + \partial_x(\frac{u^2}{2}) &=& 0 \textbf{, } x \in ]-1,2[ \\
	u(0,t) &=& 1, \\
	u(x,0) &=& \left\{ \begin{matrix}
		1 \text{ si } x<0 \\
		1-x \text{ si } 0\leq x \leq 1 \\
		0 \text{ si } x>1	
	\end{matrix} \right.
\end{matrix} \right.
\label{eq3} \tag{Burgers1}
\]

On va utiliser la méthode de la caractéristique. On cherche $t \longmapsto x(t)$ tel que $u(x(t),t) = cte$.

On suppose qu'il existe un tel $x(t)$, d'une part, on a :

\begin{eqnarray*}
	\frac{\partial (u(x(t),t))}{\partial t} &=& 0 \\
	\frac{\partial u}{\partial t}(x(t),t) + x'(t) \frac{\partial u}{\partial x}(x(t),t) &=& 0
\end{eqnarray*}

D'autre part $u$ vérifie l'équation du burgers :

\begin{eqnarray*}
	\frac{\partial u}{\partial t} + \frac{\partial (u^2/2)}{\partial x} = 0 \\
	\frac{\partial u}{\partial t} + u \frac{\partial u}{\partial x} = 0 \\
	\frac{\partial u}{\partial t}(x(t),t) + u(x(t),t) \frac{\partial u}{\partial x}(x(t),t) = 0 
\end{eqnarray*}

Par identification, on a :
\[ x'(t) = u(x(t),t) \]

Et puisque $t \longmapsto x(t)$ est une courbe caractéristique, on a :
\[x'(t) = u(x(0),0) = cte\]

Donc $t \longmapsto x(t)$ est une droite.

Si une courbe caractéristique existe alors c'est une droite de direction $u(x(0),0)$.
\newline

Remarque : $u(x,t) = u(x_0,0)$ avec $x_0$ tel que $x = u(x_0,0) t + x_0$.
\newline

Réciproquement, prenons une tel courbe et prouvons quelle est caractéristique. Soit $x_0 \in R$ et $t \longmapsto x(t) = u(x_0,0) t + x_0$ :

\begin{eqnarray*}
	\frac{d (u(x(t),t))}{dt} &=& x'(t) \frac{\partial u}{\partial x}(x(t),t) + \frac{\partial u}{\partial t}(x(t),t) \\
	&=& u(x(0),0) \frac{\partial u}{\partial x}(x(t),t) + \frac{\partial u}{\partial t}(x(t),t) \\
	&=& u(x(0),0) \frac{\partial u}{\partial x}(x(t),t) - u(x(t),t) \frac{\partial u}{\partial x}(x(t),t) \\
	&=& \frac{\partial u}{\partial x}(x(t),t) \left( u(x(0),0)-u(x(t),t) \right)
\end{eqnarray*}

Alors, les courbes caractéristiques sont de la forme $t longmapsto x(t) = u(x_0,0) t + x_0$.

On a alors :

\[
x(t) = \left\{ \begin{matrix}
	t + x_0 \text{ pour } x_0 < 0 \\
	(1-x_0) t + x_0 \text{ pour } 0 \leq x_0 \leq 1 \\
	x_0 \text{ pour } x_0 > 1
\end{matrix} \right. \]

\begin{figure}[H]
  \input{figure/figure1.tex}
  \caption{Courbes caractéristiques \ref{eq3}}
\end{figure}

On voit que deux courbes peuvent se croiser. Nous obtenons 4 zones.

\begin{figure}[H]
  \input{figure/figure2.tex}
  \caption{Différentes zones \ref{eq3}}
\end{figure}

La zone 1 ($\{(x,t) \in R \times R^{+}, x < 1, t > x\}$) donne $u(x,t) = 1$.

La zone 2 ($\{(x,t) \in R \times R^{+}, x > 1, t < x\}$) donne $u(x,t) = 0$.

La zone 3 ($\{(x,t) \in R \times R^{+}, 0 < x < 1, x < t \}$), nous donne :

\begin{eqnarray*}
	u(x,t) &=& 1 - x_0 \text{ avec } x = (1-x_0) t + x_0 \\
	u(x,t) &=& 1 - \frac{x-t}{1-t} \text{ en effet } x_0 = \frac{x-t}{1-t} \\
	u(x,t) &=& \frac{1-x}{1-t}  
\end{eqnarray*}

La zone 4 ($\{(x,t) \in R \times R^+, x > 1, t > x\}$), nous donne :

Pour trouver la valeur de $u(x,t)$, nous devons intégrer un choc. Nous avons $u_L=1$ et $u_R=0$. Donc la vitesse du choc s'exprime :
\[ \frac{dx}{dt} = \sigma = \frac{u_L^2/2 - u_R^2/2}{u_L - u_R} = \frac{1}{2} \frac{(u_L-u_R)(u_L+u_R)}{u_L-u_R} = \frac{u_L+u_R}{2} = \frac{1}{2} \]

Donc le choc se trouve sur la droite de pente $2$ et passant par $(1,1)$ :
\[ x = 2 (t - 1) + 1 = 2t + 2 \]

On obtiens que sur $\text{zone 4 } \cap \{(x,t), t+1 > x/2\}$, $u(x,t) = 1$ et sur $\text{zone 4 } \cap \{(x,t), t+1 < x/2\}$, $u(x,t) = 0$.
\newline

Nous avons résolue le problème au sens de Lax et la solution est : 

\[u(x,t) = \left\{ \begin{matrix}
	1 \text{ pour } x<1, t>x \text{ ou } x>1, t+1>x/2 \\
	\frac{1-x}{1-t} \text{ pour } 0<x<1 \text{ ou } x<t \\
	0 \text{ pour } x>1, t+1<x/2
\end{matrix} \right.
\tag{Sol3}
\]

\begin{figure}[H]
  \input{figure/figure3.tex}
  \caption{Solution de l'équation \ref{eq3}}
\end{figure}

\subsubsection*{2.}

Résolvons le problème de Riemann pour l'équation de Burgers :

\[ \left\{ \begin{matrix}
	\frac{\partial u}{\partial t} + \frac{\partial (u^2/2)}{\partial x} = 0 \\
	u(x,0) = \left\{ \begin{matrix}
					u_L \text{ pour } x<0 \\
					u_R \text{ pour } x>0
	\end{matrix} \right.
\end{matrix} \right.
\label{eq4} \tag{Burgers2}
\]

Nous avons vu précédement que les courbes caractéristiques de l'équation de Burgers sont des droites de pente $u(x_0,0)^{-1}$. Soit pour $x_0<0$, ces droites ont une pente de $u_L^{-1}$ et pour $x_0>0$, elles ont une pente $u_R^{-1}$.
\newline

Nous avons deux cas :

$\bullet$ $u_L < u_R$, alors $u_L^{-1} > u_R^{-1}$. Les courbes caractéristiques ne se rencontrent pas.

\begin{figure}[H]
  \input{figure/figure4.tex}
  \caption{Courbes caractéristiques pour $u_L < u_R$ \ref{eq4}}
\end{figure}

Nous avons trois zones :

- $zone1 = (x,t)$ tel que $x < u_L t$, on a $u(x,t) = u_L$

- $zone2 = (x,t)$ tel que $x > u_R t$, on a $u(x,t) = u_R$

- $zone3 = (x,t)$ tel que $u_L t < x < u_R t$ qui est plus complexe.

\begin{figure}[H]
  \input{figure/figure5.tex}
  \caption{Différentes zones $u_L < u_R$ \ref{eq4}}
\end{figure}

Résolvons l'équation sur la deuxième partie. On veut trouver une fonction sur cet ensemble qui vérifie l'équation de Burgers et que la fonction globale soit continue.

Regardons $\tilde{u}(x,t) = \frac{x}{t}$ sur $zone3$. Ce raccord fonctionne-t'il ?

D'une part :
\[ \frac{\partial \tilde{u}}{\partial t}(x,t) = -\frac{x}{t^2} \]


D'autre part :
\[ \tilde{u}((x,t) \frac{\partial \tilde{u}}{\partial}(x,t) = \frac{x}{t} \times \frac{1}{t} = \frac{x}{t^2} \]

On a que $\tilde{u}($ vérifie l'équation de Burgers sur la $zone3$.
\[ \frac{\partial \tilde{u}}{\partial t}(x,t) + \tilde{u}(x,t) \frac{\partial \tilde{u}}{\partial}(x,t) = -\frac{x}{t^2} + \frac{x}{t^2} = 0 \]

Maintenant, regardons si la fonction globale  (qui vérifie l'équation)
\[
u(x,t) = \left\{ \begin{matrix}
			u_L \text{ pour } x < u_L t \\
			\frac{x}{t} \text{ pour } u_L t < x < u_R t \\
			u_R \text{ pour } x > u_R t
\end{matrix} \right.
\tag{Sol4.1}
\]

est continue.

$f$ est continue sur les 3 zones, il faut regarder aux frontières :

Pour $x = u_L t$ : $f(x,t) = \frac{u_L t}{t} = u_L$ et pour $x = u_R t$ : $f(x,t) = \frac{u_R t}{t} = u_R$.
\newline

Alors la fonction $u$ vérifie l'équation au sens de Lax.

\begin{figure}[H]
  \input{figure/figure6.tex}
  \caption{Solution de l'équation $u_L < u_R$ \ref{eq4}}
\end{figure}


$\bullet$ $u_L > u_R$, alors $u_L^{-1} < u_R^{-1}$. Les courbes caractéristiques se rencontrent (toutes les courbes de droite rencontre toutes les courbes de gauche).

\begin{figure}[H]
  \input{figure/figure7.tex}
  \caption{Courbes caractéristiques $u_L > u_R$ \ref{eq4}}
\end{figure}

Il faut intégrer un choc de vitesse $\sigma$, comme calculer dans la question précédente, nous avons :
\[ \sigma = \frac{u_L+u_R}{2} \]

La frontière du choc est une droite de pente $\sigma^{-1}$ et d'origine $(0,0)$. Soit une droite d'équation : $x = \sigma t$. Une solution au sens de Lax est :

\[ u(x,t) = \left\{ \begin{matrix}
				u_L \text{ pour } x < \sigma t \\
				u_R \text{ pour } x > \sigma t \\
\end{matrix}\right.
\tag{Sol4.2} \]

\begin{figure}[H]
  \input{figure/figure8.tex}
  \caption{Solution de l'équation $u_L > u_R$ \ref{eq4}}
\end{figure}

\subsubsection*{3.}

\begin{recap}{Schéma de Godunov pour l'équation de burgers}

Pour l'équation de transport (avec $c>0$), nous avons :

$\bullet$ $f(u) = \frac{u^2}{2}$

$\bullet$ Solveur de Riemann ($\sigma = \frac{u_L+u_R}{2}$) :
\[ R(u_L, u_R, z) = \left\{ \begin{matrix}

	\left\{ \begin{matrix}
		u_L \text{ pour } z < u_L \\
		z \text{ pour } u_L < z < u_R \\
		u_R \text{ pour } z > u_R	
	\end{matrix} \right. \text{ si } u_L < u_R \\	
	
	\left\{ \begin{matrix} 
		u_L \text{ pour } z < \sigma \\
		u_R \text{ pour } z > \sigma
	\end{matrix} \right. \text{ si } u_L > u_R

	\end{matrix} \right. \]

$\bullet$ Flux de Godunov pour le cas $u_L > u_R$ :
\[ f(a,b) = \frac{R(u_L,u_R,0)^2}{2}\]

\end{recap}

\subsubsection*{4.}

J'ai détaillé avant la correction MUSCL.
\newline


Voici le résultat de mes codes pour l'équation de Burgers :

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/burgers_1.png}
	\caption{Résolution équation de burgers pour $t=0.5$}
\end{figure} 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/burgers_2.png}
	\caption{Résolution équation de burgers pour $t=0.5$}
\end{figure} 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/burgers_3.png}
	\caption{Résolution équation de burgers pour $t=0.5$}
\end{figure}

Nous pouvons observer qu'il y a un problème notament au niveau des temps. Il doit y avoir 
des problèmes au niveau de la discrétisation en temps. 
\newline

Voici le graphique des erreurs en norme $L^1$ en fonction de $N$ :

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{figure/error_burgers.png}
\end{figure} 

\end{document}
